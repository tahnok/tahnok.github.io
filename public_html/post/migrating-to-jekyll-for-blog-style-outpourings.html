<!DOCTYPE html>
<html>

  <head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <title>Migrating to jekyll for blog style outpourings</title>
  <meta name="description" content="Recently, my (previous) blog hosting platform decided to axe their free tier and the price they were asking was too much for me. Plus, I’d be thinking for a ...">

  <link rel="stylesheet" href="/css/main.css">
  <link rel="canonical" href="https://blog.tahnok.me/post/migrating-to-jekyll-for-blog-style-outpourings.html">
  <link rel="alternate" type="application/rss+xml" title="(Fake) Markov Chains" href="https://blog.tahnok.me/feed.xml" />
</head>


  <body>

    <header class="site-header">

  <div class="wrapper">

    <a class="site-title" href="/">(Fake) Markov Chains</a>

    <nav class="site-nav">
      <a href="#" class="menu-icon">
        <svg viewBox="0 0 18 15">
          <path fill="#424242" d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.031C17.335,0,18,0.665,18,1.484L18,1.484z"/>
          <path fill="#424242" d="M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0c0-0.82,0.665-1.484,1.484-1.484 h15.031C17.335,6.031,18,6.696,18,7.516L18,7.516z"/>
          <path fill="#424242" d="M18,13.516C18,14.335,17.335,15,16.516,15H1.484C0.665,15,0,14.335,0,13.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.031C17.335,12.031,18,12.696,18,13.516L18,13.516z"/>
        </svg>
      </a>

      <div class="trigger">
        
          
          <a class="page-link" href="/about/">About</a>
          
        
          
          <a class="page-link" href="/archive/">Archive</a>
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          <a class="page-link" href="https://tiny.tilde.website/@tahnok">tahnok@tiny.tilde.town</a>
      </div>
    </nav>

  </div>

</header>


    <div class="page-content">
      <div class="wrapper">
        <div class="post">

  <header class="post-header">
    <h1 class="post-title">Migrating to jekyll for blog style outpourings</h1>
    <p class="post-meta">Mar 15, 2015</p>
  </header>

  <article class="post-content">
    <p>Recently, my (previous) blog hosting platform decided to axe their free tier and the price they were asking was too much for me. Plus, I’d be thinking for a long time about how it would be nice to do the hosting by myself. In addition to cutting my dependence on an external service, I’d get to learning more about ops-y things in the process.</p>

<p>My first attempt at this migration was with Octopress, which I’d dabled with a bit in the past. I quickly abandoned it though because it felt much too complicated. The default theme was split too many times, there were weird and (to me) unneeded layers of complexity.</p>

<p>Instead, I chose to use the platform Octopress is based on: Jekyll. It produces a nice clean site of interlinked and static HTML pages (which should be easy to host). It consumes posts or pages in either markdown or html, so I can write a post however I want. It has a simple template system and a theme that fits in my head so I can make it look like how I want without throwing something at the wall.</p>

<p>Important the old content was a bit tricky, but there’s a nice plugin someone wrote to import an rss feed into jekyll that you can find <a href="https://github.com/jekyll/jekyll-import">here</a>. Just run <code class="language-plaintext highlighter-rouge">jekyll import rss --source http://blog.domain</code></p>

<p>The only challenge I had was importing the images from the old site. I ended up writing a little script to grab a list of all the images, download them and then replace the src with a local reference. Here’s the source for that</p>

<figure class="highlight"><pre><code class="language-ruby" data-lang="ruby"><span class="nb">require</span> <span class="s1">'nokogiri'</span>
<span class="nb">require</span> <span class="s1">'net/http'</span>
<span class="nb">require</span> <span class="s1">'pry'</span>

<span class="no">Dir</span><span class="p">.</span><span class="nf">glob</span><span class="p">(</span><span class="s2">"octopress/source/_posts/*.html"</span><span class="p">).</span><span class="nf">each</span> <span class="k">do</span> <span class="o">|</span><span class="n">file_name</span><span class="o">|</span>
  <span class="n">file</span> <span class="o">=</span> <span class="no">File</span><span class="p">.</span><span class="nf">open</span><span class="p">(</span><span class="n">file_name</span><span class="p">,</span> <span class="s1">'r+'</span><span class="p">)</span>
  <span class="n">post</span> <span class="o">=</span> <span class="n">file</span><span class="p">.</span><span class="nf">read</span>
  <span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">,</span><span class="n">c</span> <span class="o">=</span> <span class="n">post</span><span class="p">.</span><span class="nf">split</span><span class="p">(</span><span class="s2">"---"</span><span class="p">)</span>
  <span class="n">doc</span> <span class="o">=</span> <span class="no">Nokogiri</span><span class="o">::</span><span class="no">HTML</span><span class="o">::</span><span class="n">fragment</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>

  <span class="n">doc</span><span class="p">.</span><span class="nf">css</span><span class="p">(</span><span class="s1">'img'</span><span class="p">).</span><span class="nf">each</span> <span class="k">do</span> <span class="o">|</span><span class="n">elm</span><span class="o">|</span>
    <span class="n">img_elm</span> <span class="o">=</span> <span class="n">elm</span><span class="p">[</span><span class="s1">'src'</span><span class="p">]</span>
    <span class="n">uri</span> <span class="o">=</span> <span class="no">URI</span><span class="p">(</span><span class="n">img_elm</span><span class="p">)</span>
    <span class="n">filename</span> <span class="o">=</span> <span class="s2">"temp/"</span> <span class="o">+</span> <span class="no">File</span><span class="p">.</span><span class="nf">basename</span><span class="p">(</span><span class="n">uri</span><span class="p">.</span><span class="nf">to_s</span><span class="p">)</span>
    <span class="k">if</span> <span class="no">File</span><span class="p">.</span><span class="nf">exists?</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
      <span class="nb">puts</span> <span class="s2">"skipping "</span> <span class="o">+</span> <span class="n">filename</span>
    <span class="k">else</span>
      <span class="no">File</span><span class="p">.</span><span class="nf">open</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="s1">'wb'</span><span class="p">)</span> <span class="k">do</span> <span class="o">|</span><span class="n">image</span><span class="o">|</span>
        <span class="nb">puts</span> <span class="s2">"downloading "</span> <span class="o">+</span> <span class="n">img_elm</span>
        <span class="n">image</span><span class="p">.</span><span class="nf">write</span><span class="p">(</span><span class="no">Net</span><span class="o">::</span><span class="no">HTTP</span><span class="p">.</span><span class="nf">get</span><span class="p">(</span><span class="n">uri</span><span class="p">))</span>
        <span class="nb">sleep</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
      <span class="k">end</span>
    <span class="k">end</span>

    <span class="n">elm</span><span class="p">[</span><span class="s1">'src'</span><span class="p">]</span> <span class="o">=</span> <span class="s2">"../images/"</span> <span class="o">+</span> <span class="no">File</span><span class="p">.</span><span class="nf">basename</span><span class="p">(</span><span class="n">uri</span><span class="p">.</span><span class="nf">to_s</span><span class="p">)</span>
  <span class="k">end</span>
  <span class="n">file</span><span class="p">.</span><span class="nf">rewind</span>
  <span class="n">file</span><span class="p">.</span><span class="nf">truncate</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
  <span class="n">file</span><span class="p">.</span><span class="nf">truncate</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
  <span class="n">file</span><span class="p">.</span><span class="nf">write</span><span class="p">([</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">,</span><span class="n">doc</span><span class="p">.</span><span class="nf">to_html</span><span class="p">].</span><span class="nf">join</span><span class="p">(</span><span class="s2">"---"</span><span class="p">))</span>
  <span class="n">file</span><span class="p">.</span><span class="nf">close</span>
<span class="k">end</span></code></pre></figure>

<p>What’s cool is that code up there is hosted on my site! I had been using gists before, but that’s just one more thing that was outside of my control.</p>

<p>I considered a few alternatives. Wordpress is kind of the standard for this sort of thing, but it feels like there’s a 0day every other week for it and I’m bad at patching. Plus I need a server capable of running a LAMP stack, whereas with something static (like this) I could host it on a 128 MB VPS that costs 15$ a year. Wait, <a href="http://buyvm.net/">that’s what I’m doing</a>. Ghost looked interesting, but I don’t know much about node or hosting a node site. I even thought about rolling my own, but  I tried that with <a href="https://github.com/tahnok/blag">blag</a> and it didn’t turn out quite the way I was hoping.</p>

<p>I will miss being able to write and publish a post anywhere I have an evernote account, but I think jekyll is good enough for now.</p>

<p>(ps do the comments work?)</p>

  </article>

</div>

      </div>
    </div>

    <footer class="site-footer">

  <div class="wrapper">

    <div class="footer-col-wrapper">
      <div class="footer-col  footer-col-1">
        <ul class="contact-list">
          <li>(Fake) Markov Chains</li>
          <li><a href="mailto:tahnok@gmail.com">tahnok@gmail.com</a></li>
        </ul>
      </div>

      <div class="footer-col  footer-col-2">
        <ul class="social-media-list">
        </ul>
      </div>

      <div class="footer-col  footer-col-3">
        <p class="text">WARNING: The content contained herein may or may not be sensical. Side effects may include laughter, anger, shallow thoughts, deep thoughts and blindness. Reader discretion is advised
</p>
      </div>
    </div>

  </div>

</footer>


  </body>

</html>
